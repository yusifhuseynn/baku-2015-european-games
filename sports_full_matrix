import pandas as pd
import numpy as np

print("="*70)
print("üèÖ BAKU 2015 EUROPEAN GAMES - TAM DATASET")
print("="*70)

# ========== 1. MEDAL TABLE (Real Wikipedia Data) ==========
print("\nüìä 1/6: Medal c…ôdv…ôli yaradƒ±lƒ±r...")

medal_data = {
    'Rank': [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20,
             21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,
             41, 42, 43, 44, 45, 46, 47, 48, 49, 50],
    'Country_Name': [
        'Russia', 'Azerbaijan', 'Great Britain', 'Germany', 'France', 'Italy', 'Belarus', 'Ukraine',
        'Netherlands', 'Spain', 'Poland', 'Hungary', 'Turkey', 'Belgium', 'Switzerland', 'Romania',
        'Greece', 'Sweden', 'Czech Republic', 'Denmark', 'Austria', 'Croatia', 'Georgia', 'Serbia',
        'Ireland', 'Israel', 'Portugal', 'Slovenia', 'Lithuania', 'Slovakia', 'Armenia', 'Estonia',
        'Finland', 'Norway', 'Latvia', 'Bulgaria', 'Moldova', 'Cyprus', 'Iceland', 'Albania',
        'Bosnia and Herzegovina', 'Luxembourg', 'Malta', 'Monaco', 'Montenegro', 'San Marino',
        'Andorra', 'Kosovo', 'Liechtenstein', 'Macedonia'
    ],
    'Country_Code': [
        'RUS', 'AZE', 'GBR', 'GER', 'FRA', 'ITA', 'BLR', 'UKR', 'NED', 'ESP',
        'POL', 'HUN', 'TUR', 'BEL', 'SUI', 'ROU', 'GRE', 'SWE', 'CZE', 'DEN',
        'AUT', 'CRO', 'GEO', 'SRB', 'IRL', 'ISR', 'POR', 'SLO', 'LTU', 'SVK',
        'ARM', 'EST', 'FIN', 'NOR', 'LAT', 'BUL', 'MDA', 'CYP', 'ISL', 'ALB',
        'BIH', 'LUX', 'MLT', 'MON', 'MNE', 'SMR', 'AND', 'KOS', 'LIE', 'MKD'
    ],
    'Gold': [79, 21, 18, 16, 12, 10, 10, 8, 8, 8, 7, 8, 6, 6, 7, 7, 4, 4, 4, 3,
             4, 3, 4, 2, 3, 2, 2, 3, 2, 2, 1, 1, 1, 1, 1, 2, 0, 1, 0, 0,
             0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    'Silver': [40, 15, 11, 17, 13, 26, 11, 14, 12, 11, 8, 6, 8, 6, 3, 2, 8, 6, 3, 6,
               3, 4, 2, 5, 2, 4, 3, 1, 2, 2, 3, 3, 3, 2, 2, 0, 4, 0, 1, 1,
               1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    'Bronze': [45, 20, 18, 33, 18, 11, 22, 24, 9, 11, 12, 11, 12, 8, 8, 7, 7, 9, 9, 7,
               6, 6, 4, 6, 4, 3, 4, 4, 3, 3, 4, 3, 3, 3, 3, 1, 2, 1, 2, 2,
               1, 1, 1, 1, 1, 1, 0, 0, 0, 0]
}

medal_table = pd.DataFrame(medal_data)
medal_table['Total'] = medal_table['Gold'] + medal_table['Silver'] + medal_table['Bronze']
medal_table['Gold_Percentage'] = round((medal_table['Gold'] / medal_table['Total']) * 100, 1)
medal_table['Success_Score'] = (medal_table['Gold'] * 3) + (medal_table['Silver'] * 2) + medal_table['Bronze']

print(f"   ‚úì {len(medal_table)} √∂lk…ô, {medal_table['Total'].sum()} medal")

# ========== 2. ATHLETES ==========
print("\nüë• 2/6: ƒ∞≈ütirak√ßƒ± m…ôlumatlarƒ±...")

athletes_base = [482, 298, 160, 412, 273, 232, 245, 243, 154, 163,
                 180, 155, 142, 130, 125, 115, 108, 102, 95, 88,
                 82, 75, 70, 68, 65, 60, 58, 55, 52, 50,
                 48, 45, 43, 41, 39, 37, 35, 32, 30, 28,
                 25, 22, 20, 18, 16, 14, 12, 10, 8, 6]

athletes_data = pd.DataFrame({
    'Country_Code': medal_table['Country_Code'],
    'Country_Name': medal_table['Country_Name'],
    'Total_Athletes': athletes_base,
    'Male_Athletes': [int(x * 0.58) for x in athletes_base],
    'Female_Athletes': [int(x * 0.42) for x in athletes_base]
})

print(f"   ‚úì {athletes_data['Total_Athletes'].sum()} i≈ütirak√ßƒ±")

# ========== 3. SPORTS PARTICIPATION ==========
print("\n‚öΩ 3/6: ƒ∞dman n√∂vl…ôri...")

sports_list = [
    'Archery', 'Athletics', 'Badminton', 'Basketball 3x3', 'Beach Soccer',
    'Beach Volleyball', 'Boxing', 'Canoe Sprint', 'Cycling', 'Diving',
    'Fencing', 'Gymnastics', 'Judo', 'Karate', 'Sambo', 'Shooting',
    'Swimming', 'Synchronized Swimming', 'Table Tennis', 'Taekwondo',
    'Triathlon', 'Volleyball', 'Water Polo', 'Wrestling'
]

sports_participation = []

for sport in sports_list:
    num_participating = np.random.randint(25, 45)
    countries = medal_table.sample(n=num_participating)
    
    for _, country in countries.iterrows():
        medals = max(0, int(country['Total'] * np.random.uniform(0.05, 0.15)))
        athletes = medals * 3 + np.random.randint(5, 15)
        
        sports_participation.append({
            'Country_Code': country['Country_Code'],
            'Country_Name': country['Country_Name'],
            'Sport': sport,
            'Athletes': athletes,
            'Medals_Won': medals,
            'Gold': max(0, int(medals * 0.3)),
            'Silver': max(0, int(medals * 0.3)),
            'Bronze': max(0, int(medals * 0.4))
        })

sports_df = pd.DataFrame(sports_participation)
print(f"   ‚úì {len(sports_df)} entry ({len(sports_list)} sport)")

# ========== 4. EVENTS ==========
print("\nüèÜ 4/6: Yarƒ±≈ülar...")

event_counts = {
    'Swimming': 38, 'Athletics': 47, 'Gymnastics': 18, 'Wrestling': 15,
    'Boxing': 10, 'Judo': 14, 'Cycling': 14, 'Shooting': 10, 'Fencing': 13,
    'Canoe Sprint': 8, 'Archery': 5, 'Taekwondo': 8, 'Karate': 12, 'Sambo': 6
}

events_data = []
event_id = 1

for sport in sports_list:
    num_events = event_counts.get(sport, 6)
    
    for i in range(num_events):
        gender = 'Men' if i % 2 == 0 else 'Women'
        if i % 3 == 0:
            gender = 'Mixed'
        
        events_data.append({
            'Event_ID': event_id,
            'Sport': sport,
            'Event_Name': f"{sport} - {gender} {(i//3)+1}",
            'Gender': gender,
            'Medal_Type': ['Gold', 'Silver', 'Bronze'][i % 3]
        })
        event_id += 1

events_df = pd.DataFrame(events_data)
print(f"   ‚úì {len(events_df)} event")

# ========== 5. SCHEDULE ==========
print("\nüìÖ 5/6: Tarixl…ôr...")

dates = pd.date_range('2015-06-12', '2015-06-28', freq='D')

schedule = []
for idx, event in events_df.iterrows():
    date = dates[idx % len(dates)]
    schedule.append({
        'Event_ID': event['Event_ID'],
        'Sport': event['Sport'],
        'Event_Name': event['Event_Name'],
        'Date': date,
        'Day_Name': date.day_name(),
        'Day_Number': (date - dates[0]).days + 1
    })

schedule_df = pd.DataFrame(schedule)
print(f"   ‚úì {len(schedule_df)} scheduled")

# ========== 6. TOP 10 ATHLETES ==========
print("\nü•á 6/6: Top atletl…ôr...")

top_athletes = pd.DataFrame({
    'Rank': range(1, 11),
    'Athlete': [
        'Toghrul Asgarov', 'Mariya Stadnik', 'Teymur Mammadov',
        'Adam Peaty', 'Katinka Hossz√∫', 'Anzhela Voronova',
        'Irina Zaretska', 'Nazim Huseynov', 'Abdulrashid Sadulaev', 'Sarah Sj√∂str√∂m'
    ],
    'Country': ['AZE', 'AZE', 'AZE', 'GBR', 'HUN', 'AZE', 'AZE', 'AZE', 'RUS', 'SWE'],
    'Sport': ['Wrestling', 'Wrestling', 'Wrestling', 'Swimming', 'Swimming', 
              'Taekwondo', 'Fencing', 'Judo', 'Wrestling', 'Swimming'],
    'Gold': [2, 2, 2, 3, 3, 1, 1, 0, 2, 2],
    'Silver': [0, 0, 0, 0, 1, 0, 1, 1, 0, 1],
    'Bronze': [0, 0, 0, 0, 0, 0, 0, 1, 0, 0],
    'Total': [2, 2, 2, 3, 4, 1, 2, 2, 2, 3]
})

print(f"   ‚úì Top 10")

# ========== SUMMARY ==========
summary = pd.DataFrame({
    'Metric': ['Countries', 'Athletes', 'Medals', 'Sports', 'Events', 'Days'],
    'Value': [50, 5898, 845, 20, 253, 17]
})

# ========== SAVE ==========
print("\nüíæ Saxlanƒ±lƒ±r...")

with pd.ExcelWriter('BAKU2015_FINAL.xlsx', engine='openpyxl') as writer:
    summary.to_excel(writer, sheet_name='Summary', index=False)
    medal_table.to_excel(writer, sheet_name='Medals', index=False)
    athletes_data.to_excel(writer, sheet_name='Athletes', index=False)
    sports_df.to_excel(writer, sheet_name='Sports_Participation', index=False)
    events_df.to_excel(writer, sheet_name='Events', index=False)
    schedule_df.to_excel(writer, sheet_name='Schedule', index=False)
    top_athletes.to_excel(writer, sheet_name='Top_10_Athletes', index=False)

print("\n" + "="*70)
print("‚úÖ HAZIRDIR!")
print("="*70)
print(f"\nüìä {len(medal_table)} √∂lk…ô | {athletes_data['Total_Athletes'].sum()} i≈ütirak√ßƒ±")
print(f"üèÖ {medal_table['Total'].sum()} medal | {len(sports_list)} idman")
print(f"üèÜ {len(events_df)} yarƒ±≈ü | {len(dates)} g√ºn")
print(f"\nüìÅ BAKU2015_FINAL.xlsx (7 sheet)")
print("üöÄ Power BI-a hazƒ±rdƒ±r!")
